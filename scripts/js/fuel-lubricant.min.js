Ext.require(["Ext.panel.*","Ext.form.*","*"]);idgen=1;_today=Ext.Date.format(new Date,"m/d/Y");_request_code="ERQ_FL";upload_req_panel=Ext.create("Ext.panel.Panel",{title:"UPLOAD REQUIREMENTS",items:[]});
Ext.onReady(function(){request_form=Ext.create("Ext.form.FormPanel",{frame:false,border:false,autoHeight:true,renderTo:"request-form-container",autoWidth:true,fileUpload:true,defaultType:"panel",defaults:{bodyStyle:"padding:10px 10px 0 10px;",autoWidth:true,autoHeight:true,frame:true,border:true,defaultType:"panel",defaults:{frame:false,border:false,autoWidth:true,autoHeight:true,bodyStyle:"background-color:transparent; padding:3px 0 3px 0;",layout:"column",defaultType:"textfield",defaults:{readOnly:false,
width:300,labelWidth:115,allowBlank:false}}},items:[{title:"EMPLOYEE DETAILS",items:[{items:[{readOnly:true,fieldLabel:"Branch Code",name:"branchcode",id:"branch-code"},{xtype:"box",width:100,html:"&nbsp;"},{fieldLabel:"Branch",name:"branch-desc",id:"branch-desc"}]},{items:[{readOnly:true,fieldLabel:"Badge No.",name:"badge-no",id:"badge-no"},{xtype:"box",width:100,html:"&nbsp;"},{readOnly:true,fieldLabel:"Position",name:"position",id:"position"}]},{items:[{readOnly:true,fieldLabel:"Name",name:"employee_name",
id:"employee_name"},{xtype:"box",width:100,html:"&nbsp;"},{readOnly:true,fieldLabel:"Date of Request",name:"req_date",value:Ext.Date.format(new Date,"m/d/Y")}]}]},{title:"SERVICE UNIT DETAILS",items:[{items:[{xtype:"combobox",fieldLabel:"Service Type",name:"service_type",store:[["MCP","MC PLAN"],["MCL","MC LOAN"],["TSU","TEMPORARY SERVICE UNIT"],["OTHERS","OTHERS"]]}]},{items:[{xtype:"combobox",fieldLabel:"Make",name:"make"},{xtype:"box",width:100,html:"&nbsp;"},{fieldLabel:"Plate No.",name:"plate_no"}]},
{items:[{fieldLabel:"Model",name:"model"},{xtype:"box",width:100,html:"&nbsp;"},{fieldLabel:"Engine No.",name:"engine_no"}]},{items:[{fieldLabel:"Date Acquired",xtype:"datefield",editable:false,name:"acquire_date",value:_today,maxValue:_today},{xtype:"box",width:100,html:"&nbsp;"},{fieldLabel:"Chassis No.",name:"chassis_no"}]},{items:[{fieldLabel:"Odometer Reading",name:"odometer_reading"}]}]},{title:"SU EVALUATION DETAILS",items:[{items:[{xtype:"datefield",maxValue:_today,format:"m/d/Y",fieldLabel:"Last PMS Date",
name:"last_pms_date"},{xtype:"box",width:100,html:"&nbsp;"},{fieldLabel:"Serving Shop",name:"serving_shop"}]}]},{title:"REQUEST DETAILS",items:[{bodyStyle:"background-color:transparent;",defaultType:"box",defaults:{margin:"margin:0 3px 0 3px;"},items:[{html:"No.",width:45},{html:"QTY.",width:45},{html:"Description",width:150},{html:"Brand Name",width:100},{html:"Date of Last Request",width:135},{html:"Canvassed Price",width:400}]},{defaults:{style:"margin:0 3px 0 3px;"},items:[{xtype:"box",width:500,
html:"&nbsp;"},{xtype:"displayfield",width:99,value:"PCI",name:"store1_name"},{xtype:"textfield",allowBlank:false,width:100,name:"store2_name"},{xtype:"textfield",allowBlank:false,width:100,name:"store3_name"}]},{defaults:{style:"margin:0 3px 0 3px;",enableKeyEvents:true},items:[{xtype:"textfield",allowBlank:false,name:"no_field",readOnly:true,width:45,value:idgen},{xtype:"textfield",allowBlank:false,value:1,readOnly:true,name:"qty_field",width:45},{xtype:"combobox",allowBlank:false,name:"desc_cmb",
width:150},{xtype:"textfield",allowBlank:false,name:"brand_field",width:100},{xtype:"datefield",allowBlank:false,name:"last_req_date",width:135,maxValue:_today,editable:false,format:"m/d/Y"},{xtype:"numberfield",allowBlank:false,name:"store1_amount",id:"store1_amount",width:100},{xtype:"numberfield",allowBlank:false,id:"store2_amount",name:"store2_amount",width:100},{xtype:"numberfield",allowBlank:false,id:"store3_amount",name:"store3_amount",width:100}]},{defaultType:"textfield",padding:"30px 0 3px 0",
items:[{fieldLabel:"Verified by",name:"verifier_badgeno",id:"verifier_badgeno_field",emptyText:"Badge No.",width:200},{name:"verifier_name",id:"verifier_name_field",emptyText:"Service Mechanic",readOnly:true,width:200},{xtype:"box",width:18,html:"&nbsp;"},{xtype:"datefield",editable:false,labelWidth:100,fieldLabel:"Date Verified",name:"verified-date",maxValue:_today,value:_today}]},{defaultType:"textfield",items:[{fieldLabel:"Recommended by",id:"recommend_badgeno_field",name:"recommend_badgeno",emptyText:"Badge No.",
width:200},{name:"recommend_name",id:"recommend_name_field",readOnly:true,emptyText:"Branch Manager",width:200}]}]}],buttonAlign:"center",buttons:[{text:"Submit",id:"submit-btn",name:"submit",iconCls:"submit-icon",handler:function(){var form=request_form.getForm();if(form.isValid())form.submit({url:"?page=fuelLubricant&action=sendRequest",method:"POST",params:{REQCODE:_request_code}})}},{text:"Clear",id:"clear-btn",name:"clear",iconCls:"erase-icon",handler:function(){request_form.getForm().reset()}},
{text:"Cancel",id:"cancel-btn",name:"cancel",iconCls:"exit-icon",handler:function(){}}]});var verifier_badgeno_field=Ext.getCmp("verifier_badgeno_field"),verifier_name_field=Ext.getCmp("verifier_name_field"),recommend_badgeno_field=Ext.getCmp("recommend_badgeno_field"),recommend_name_field=Ext.getCmp("recommend_name_field");verifier_badgeno_field.on("blur",function(){if(this.isDirty()&&this.getValue()){this.resetOriginalValue();var fullname=getEmpFullname(this.getValue());if(fullname)verifier_name_field.setValue(fullname);
else{verifier_name_field.setValue("");this.focus()}}});recommend_badgeno_field.on("blur",function(){if(this.isDirty()&&this.getValue()){this.resetOriginalValue();var fullname=getEmpFullname(this.getValue());if(fullname)recommend_name_field.setValue(fullname);else{recommend_name_field.setValue("");this.focus()}}});fillFormValue()});
function fillFormValue(){var userid=Ext.get("userid").getValue(),badgeno=Ext.get("badgeno").getValue(),lastname=Ext.get("lastname").getValue(),firstname=Ext.get("firstname").getValue(),middlename=Ext.get("middlename").getValue(),fullname=Ext.get("name").getValue(),locationcode=Ext.get("locationcode").getValue(),emailaddress=Ext.get("emailaddress").getValue(),bucode=Ext.get("bucode").getValue(),sapbucode=Ext.get("sapbucode").getValue(),budesc=Ext.get("budesc").getValue(),deptcode=Ext.get("deptcode").getValue(),
groupcode=Ext.get("groupcode").getValue(),positioncode=Ext.get("positioncode").getValue(),hiredate=Ext.get("hiredate").getValue(),branchcode=Ext.get("branchcode").getValue(),birthdate=Ext.get("birthdate").getValue(),department_code=Ext.get("departmentcode").getValue(),emp_status_code=Ext.get("empstatuscode").getValue(),position_desc=Ext.get("positiondesc").getValue(),branch_desc=Ext.get("branchdesc").getValue(),department_desc=Ext.get("departmentdesc").getValue();setCmpValue("branch-code",branchcode);
setCmpValue("badge-no",badgeno);setCmpValue("employee_name",fullname);setCmpValue("branch-desc",branch_desc);setCmpValue("position",position_desc)};